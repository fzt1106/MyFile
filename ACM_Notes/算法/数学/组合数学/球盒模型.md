# 球盒模型

[(4条消息) n个球放k个盒子问题归纳_n个球k个盒子问题归纳_wancong3的博客-CSDN博客](https://blog.csdn.net/zhangwancongcsdn/article/details/104043507)

[(4条消息) 将球放入盒中的方法数总结(球盒模型问题)_Jaster_wisdom的博客-CSDN博客](https://blog.csdn.net/Jaster_wisdom/article/details/78506831)

[算法学习笔记(7)：球盒模型 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/602410836)

[球盒问题：这篇笔记来就全算了 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/429815465)

## 模型1 	隔板法1

> $n$个**无标号**的球放到$k$个**有标号**的盒子中，盒子**不允许为空**。

### 思路

隔板法：$n$个物品之间有$n-1$个空隙，从中找$k-1$个位置放隔板。

故方案数为：
$$
\pmb {C_{n-1}^{k-1}}
$$


### 应用

#### 例1：求解方程$x_1+x_2+...+x_k=n$的正整数解的个数

方案为$C_{n-1}^{k-1}$

---

## 模型2	隔板法2

> $n$个**无标号**的球放到$k$个**有标号**的盒子中，盒子**允许为空**。

### 思路

思路1：与模型1不同之处在于盒子是否允许为空，对于该问题，盒子允许为空，可以将$k$个盒子都提前加上一个球，那么盒子就一定不为空。问题转换为模型1：将$n+k$个**无标号**球放到k个**有标号**的盒子中，盒子**不允许为空**。

思路2：隔板法：由于盒子允许为空，因此隔板允许相邻，那么$k$个隔板和$n$个球之间有$n+k-1$个空隙，从中选出$k-1$个位置放隔板

故方案数为：
$$
\pmb {C_{n+k-1}^{k-1}}
$$


### 应用

#### 例1：求解方程$x_1+x_2+...+x_k=n$的非负整数解的个数

由于$x_i$非负，因此$x_i$可以为空，方案数为$C_{n+k-1}^{k-1}$

#### 例2：求解方程$x_1+x_2+x_3=n$，其中$x_1\geq 1,x_2\geq2,x_3\geq3$，的解的个数

提前对$x_1,x_2,x_3$进行**添加数/减少数**的预处理，使之符合模板1的条件：

+ $x_1$满足条件
+ $x_2$需要提前加1，总数-1
+ $x_3$需提前加2，总数-2

所有方案数为$C_{n-1-2-1}^{3-1}$

---

## 模型3 	第二类斯特林数（斯特林子集数）

> $n$个**有标号**的球放到$k$个**无标号**的盒子中，盒子**不允许为空**。

> ==第二类斯特林数（斯特林子集数）$n\brace k$，也记作$S(n,k)$，表示将$n$个两两不同的元素，划分为$k$个互不区分的非空子集的方案数==
>
> [Oi Wiki 第二类斯特林数（Stirling Number）](https://oi-wiki.org/math/combinatorics/stirling/)

### 思路

考虑**动态规划**解法，对于$n\brace k$，当插入一个新的元素，有两种方案

+ 将新元素单独放入一个子集，有$n-1 \brace k-1$种方案数
+ 将新元素放入现有的一个非空子集，有${n-1 \brace k}*k$种方案数

于是有递推公式：
$$
\pmb {S(n,k)=S(n-1,k-1)+k*S(n-1,k)}
$$

### 模板

```c++
int S[N][N];
void Stirling(){
    for(int i=0;i<N;i++){
        S[i][0]=!i;
        for(int j=1;j<=i;j++){
            S[i][j]=S[i-1][j-1]+S[i-1][j]*j;
        }
    }
}
```

---

## 模型4	第二类斯特林数变形

> $n$个**有标号**的球放到$k$个**无标号**的盒子中，盒子**允许为空**。

与模型3的差别在于盒子允许为空，由于盒子都是相同的，于是枚举空盒子的数目即可

于是方案数为：
$$
\pmb {\sum_{i=0}^{k}{n \brace k-i}}
$$

---

## 模型5

> $n$个**有标号**的球放到$k$个**有标号**的盒子中，盒子**允许为空**。
>
> 注意盒子内部不区分顺序

每个球有$k$种选择，所以方案数为
$$
\pmb {k^n}
$$

----

## 模型6

> $n$个**有标号**的球放到$k$个**有标号**的盒子中，盒子**不允许为空**。

对比模型3（斯特林子集数），由于盒子不同，因此可以把斯特林的子集全排列即可，有$n!$种情况。所以方案数为：
$$
\pmb{{n\brace k}*k!}
$$





---





==！！！！！待补==

## 模型7	k部分拆数

> $n$个**无标号**的球放到$k$个**无标号**的盒子中，盒子**不允许为空**。

> 将$n$分成恰有$k$个部分的分拆，称为$k$部分拆数，记作$p(n,k)$
>
> [Oi Wiki 分拆数](https://oi-wiki.org/math/combinatorics/partition/)

由==k部分拆数==可知，方案数为
$$
\pmb {p(n,k)=p(n-1,k-1)+p(n-k,k)}
$$

### 应用

#### 例1：方程$n-k=y_1+y_2+...+y_k\ \ (y_1\geq y_2 \geq ...\geq y_k \geq 0)$的解数



---

## 模型8

> $n$个**无标号**的球放到$k$个**无标号**的盒子中，盒子**允许为空**。





